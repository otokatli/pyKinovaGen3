from numpy import array, cos, sin


def mid_positions(q):
    '''
    Mid-point positions each link of the Kinova Gen3 robot
    
    Arguments
    ---------
    q : array_like
        The joint angles of the robot
        
    Returns
    -------
    ndarray
        The mid-point positions of the links
    '''
    
    q1 = q[0]
    q2 = q[1]
    q3 = q[2]
    q4 = q[3]
    q5 = q[4]
    q6 = q[5]
    q7 = q[6]
    
    x0 = sin(q1)
    x1 = cos(q1)
    x2 = sin(q2)
    x3 = 0.1007*x2
    x4 = cos(q2)
    x5 = -0.0118*x0
    x6 = cos(q3)
    x7 = x0*x6
    x8 = 0.3156*x2
    x9 = sin(q3)
    x10 = x1*x9
    x11 = x10*x4
    x12 = -0.0118*x1
    x13 = x1*x6
    x14 = x0*x9
    x15 = x14*x4
    x16 = x2*x9
    x17 = sin(q4)
    x18 = x13*x4 - x14
    x19 = x17*x18
    x20 = cos(q4)
    x21 = x1*x2
    x22 = x20*x21
    x23 = 0.4208*x2
    x24 = x1*x23 + x5
    x25 = -x10 - x4*x7
    x26 = x17*x25
    x27 = x0*x2
    x28 = x20*x27
    x29 = -x0*x23 + x12
    x30 = x20*x4
    x31 = x2*x6
    x32 = x17*x31
    x33 = 0.4208*x4 + 0.2848
    x34 = -0.0128*x11 + x24 - 0.0128*x7
    x35 = -0.0128*x13 + 0.0128*x15 + x29
    x36 = 0.0128*x16 + x33
    x37 = sin(q5)
    x38 = cos(q5)
    x39 = -x37*(x11 + x7) + x38*(-x17*x21 + x18*x20)
    x40 = sin(q6)
    x41 = 0.05295*x40
    x42 = -x19 - x22
    x43 = cos(q6)
    x44 = 0.05295*x43
    x45 = 0.3143*x19 + 0.3143*x22 + x34
    x46 = -x37*(x13 - x15) + x38*(x17*x27 + x20*x25)
    x47 = -x26 + x28
    x48 = 0.3143*x26 - 0.3143*x28 + x35
    x49 = x16*x37 + x38*(-x17*x4 - x20*x31)
    x50 = -x30 + x32
    x51 = 0.3143*x30 - 0.3143*x32 + x36
    x52 = 0.13665*x40
    x53 = 0.13665*x43
    return array([[-0.0027*x0, -0.0027*x1, 0.2206], [-0.0086*x0 + x1*x3, -x0*x3 - 0.0086*x1, 0.1007*x4 + 0.2848], [x1*x8 - 0.0032*x11 + x5 - 0.0032*x7, -x0*x8 + x12 - 0.0032*x13 + 0.0032*x15, 0.0032*x16 + 0.3156*x4 + 0.2848], [-0.0096*x11 + 0.1042*x19 + 0.1042*x22 + x24 - 0.0096*x7, -0.0096*x13 + 0.0096*x15 + 0.1042*x26 - 0.1042*x28 + x29, 0.0096*x16 + 0.1042*x30 - 0.1042*x32 + x33], [0.26135*x19 + 0.26135*x22 + x34, 0.26135*x26 - 0.26135*x28 + x35, 0.26135*x30 - 0.26135*x32 + x36], [x39*x41 - x42*x44 + x45, x41*x46 - x44*x47 + x48, x41*x49 - x44*x50 + x51], [x39*x52 - x42*x53 + x45, x46*x52 - x47*x53 + x48, x49*x52 - x50*x53 + x51]])
