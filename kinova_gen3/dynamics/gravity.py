"""Gravity term for Kinova Gen3 robot

Functions
---------
gravity(joint_position)

"""

import math
import numpy


def gravity(q):
    """The gravity term of the Kinova Gen3 robot

    Arguments
    ---------
    joint_position (array_like): The joint angles of the robot [rad]

    Returns
    -------
    ndarray: The gravity term of the robot

    """

    # Gravity acceleration constant [m/s^2]
    gravity_acceleration = 9.80665

    # q1 = q[0]
    q2 = q[1]
    q3 = q[2]
    q4 = q[3]
    q5 = q[4]
    q6 = q[5]
    q7 = q[6]

    x0 = q3
    x1 = math.cos(x0)
    x2 = q2
    x3 = math.sin(x2)
    x4 = x1 * x3
    x5 = math.cos(x2)
    x6 = 0.017767125 * x5
    x7 = math.sin(x0)
    x8 = x3 * x7
    x9 = 1.1636 * x5
    x10 = q4
    x11 = math.sin(x10)
    x12 = x11 * x5
    x13 = math.cos(x10)
    x14 = x13 * x3
    x15 = x13 * x5
    x16 = x11 * x4
    x17 = -x15 + x16
    x18 = x1 * x13
    x19 = x18 * x3
    x20 = 1.8e-5 * x1
    x21 = 0.9302 * x8
    x22 = 0.9302 * x17
    x23 = -x12 - x19
    x24 = 0.9302 * x23
    x25 = 1.8568 * x23
    x26 = q5
    x27 = math.cos(x26)
    x28 = math.sin(x26)
    x29 = x28 * x7
    x30 = x1 * x13 * x27 - x29
    x31 = 0.00017505 * x3
    x32 = 1.1787 * x17
    x33 = 0.10593 * x27
    x34 = 0.10593 * x3
    x35 = x23 * x28
    x36 = -x27 * x3 * x7 + x35
    x37 = -x36
    x38 = 1.1787 * x37
    x39 = 0.063883 * x27
    x40 = 0.063883 * x3
    x41 = 0.6781 * x37
    x42 = -0.10593 * x11 * x28 * x5
    x43 = x27 * x7
    x44 = x18 * x28 + x43
    x45 = -x44
    x46 = x29 * x3
    x47 = x23 * x27
    x48 = x46 + x47
    x49 = 1.1787 * x48
    x50 = 0.6781 * x48
    x51 = 0.009432 * x27
    x52 = 0.6781 * x17
    x53 = q6
    x54 = math.sin(x53)
    x55 = x13 * x54
    x56 = math.cos(x53)
    x57 = x11 * x56
    x58 = x27 * x57
    x59 = x5 * (x55 + x58)
    x60 = x11 * x54
    x61 = x13 * x27 * x56 - x60
    x62 = x1 * x61 - x29 * x56
    x63 = 0.5006 * x36
    x64 = x48 * x54
    x65 = x17 * x56 - x64
    x66 = 0.5006 * x65
    x67 = x3 * x62
    x68 = 0.6781 * x65
    x69 = x27 * x60
    x70 = x13 * x56 - x69
    x71 = x5 * x70
    x72 = -x27 * x55 - x57
    x73 = x1 * x72 + x29 * x54
    x74 = x3 * x73
    x75 = x17 * x54
    x76 = x48 * x56
    x77 = x75 + x76
    x78 = 0.6781 * x77
    x79 = 0.5006 * x77
    x80 = 0.6781 * x36
    x81 = q7
    x82 = math.cos(x81)
    x83 = x55 * x82
    x84 = math.sin(x81)
    x85 = x28 * x84
    x86 = x27 * x56 * x82 - x85
    x87 = x11 * x86
    x88 = x5 * (x83 + x87)
    x89 = x27 * x84
    x90 = x28 * x82
    x91 = x56 * x90
    x92 = x89 + x91
    x93 = x13 * x86 - x60 * x82
    x94 = x1 * x93 - x7 * x92
    x95 = x36 * x82
    x96 = x77 * x84
    x97 = -x95 - x96
    x98 = 0.5006 * x97
    x99 = x55 * x84
    x100 = -x56 * x89 - x90
    x101 = x100 * x11
    x102 = x101 - x99
    x103 = x56 * x85
    x104 = -x103 + x27 * x82
    x105 = x100 * x13 + x60 * x84
    x106 = x1 * x105 - x104 * x7
    x107 = x36 * x84
    x108 = x77 * x82
    x109 = -x107 + x108
    x110 = 0.5006 * x109
    x111 = x7**2
    x112 = 0.7235081912 * x3
    x113 = x11 * x7
    x114 = x13 * x7
    x115 = x1 * x28
    x116 = 0.00017505 * x115
    x117 = 0.00017505 * x13
    x118 = 0.10593 * x115
    x119 = 0.10593 * x13
    x120 = 0.009432 * x28
    x121 = 1.0e-6 * x27
    x122 = 1.0e-6 * x13
    x123 = x122 * x29
    x124 = 0.009432 * x13
    x125 = x119 * x29
    x126 = x13 * x29
    x127 = x61 * x7
    x128 = x7 * x72
    x129 = 0.00965 * x115
    x130 = 0.045483 * x27
    x131 = x1 * x92
    x132 = x1 * x104
    x133 = x7 * x93
    x134 = x105 * x7
    x135 = 0.000281 * x54
    x136 = 0.011402 * x54
    x137 = x11 * x17
    x138 = x11 * x28
    x139 = 1.0e-6 * x138
    x140 = 0.10593 * x138
    x141 = x13 * x56
    x142 = x28 * x56
    x143 = 0.053028558 * x36
    x144 = x28 * x54
    x145 = x27 * x82
    x146 = 0.000281 * x56
    x147 = 0.011402 * x56
    x148 = 0.029798 * x54

    gravity_term = numpy.array(
        [
            [
                gravity_acceleration
                * (
                    0.58632906 * x1 * x3**2 * x7
                    + x110
                    * (
                        -0.029798 * x102 * x5
                        - 0.029798 * x106 * x3
                        + 0.011402 * x3 * x73
                        + 0.011402 * x5 * x70
                    )
                    + 1.8568 * x17 * (0.006375 * x12 + 0.006375 * x19)
                    - x21
                    * (
                        -0.075478 * x1 * x14
                        - x11 * x20 * x3
                        - 0.075478 * x12
                        + 1.8e-5 * x13 * x5
                    )
                    + x22 * (0.015006 * x12 + 0.015006 * x19 - 1.8e-5 * x8)
                    + x24 * (-0.015006 * x15 + 0.015006 * x16 + 0.075478 * x8)
                    + x25 * (-0.006375 * x15 + 0.006375 * x16 + 0.20843 * x8)
                    + x32 * (0.00017505 * x12 * x27 + x30 * x31)
                    + x38 * (x12 * x33 + x30 * x34)
                    - x4 * x6
                    - 2.787 * x4 * (-0.006375 * x5 + 0.21038 * x8)
                    - 1.1636 * x4 * (0.006641 * x5 + 0.117892 * x8)
                    + x41 * (x12 * x39 + 1.0e-6 * x15 - 1.0e-6 * x16 + x30 * x40)
                    + x49
                    * (0.00017505 * x1 * x11 * x3 - 0.00017505 * x15 - x34 * x45 - x42)
                    + x50
                    * (
                        0.063883 * x11 * x28 * x5
                        + 0.009432 * x13 * x5
                        - 0.009432 * x16
                        - x40 * x45
                    )
                    + x52
                    * (
                        1.0e-6 * x11 * x28 * x5
                        - x12 * x51
                        - 0.009432 * x3 * x30
                        - 1.0e-6 * x3 * x45
                    )
                    + x63 * (-x34 * x62 - 0.10593 * x59)
                    + x66 * (x31 * x62 + 0.00017505 * x59)
                    + x66
                    * (
                        0.000281 * x102 * x5
                        + 0.000281 * x106 * x3
                        - 0.011402 * x3 * x94
                        - 0.011402 * x88
                    )
                    + x68
                    * (
                        1.0e-6 * x12 * x28
                        + 1.0e-6 * x3 * x44
                        + 0.00965 * x59
                        + 0.00965 * x67
                    )
                    + x78
                    * (
                        0.045483 * x11 * x28 * x5
                        + 0.045483 * x3 * x44
                        - 0.00965 * x71
                        - 0.00965 * x74
                    )
                    + x79 * (0.10593 * x3 * x44 - x31 * x73 - x42 - 0.00017505 * x71)
                    + 1.1636 * x8 * (0.117892 * x4 - 4.4e-5 * x5)
                    - 1.8568 * x8 * (-0.20843 * x1 * x14 - 0.20843 * x12)
                    + x80
                    * (-0.045483 * x59 - 0.045483 * x67 - 1.0e-6 * x71 - 1.0e-6 * x74)
                    - x9 * (-0.006641 * x4 - 4.4e-5 * x8)
                    + x98
                    * (
                        0.029798 * x3 * x94
                        - 0.000281 * x71
                        - 0.000281 * x74
                        + 0.029798 * x88
                    )
                )
            ],
            [
                gravity_acceleration
                * (
                    -(x1**2) * x112
                    + x110
                    * (
                        x115 * x136
                        - 0.011402 * x128
                        + 0.029798 * x132
                        + 0.029798 * x134
                    )
                    - x111 * x112
                    - 0.387012824 * x111 * x14
                    - 0.0118371 * x114 * x17
                    - x21 * (1.8e-5 * x113 + 0.075478 * x114)
                    + x22 * (-0.015006 * x114 - x20)
                    + x24 * (0.075478 * x1 - 0.015006 * x113)
                    + x25 * (0.20843 * x1 - 0.006375 * x113)
                    - 0.946998516 * x3
                    + x32 * (-x116 - x117 * x43)
                    + x38 * (-x118 - x119 * x43)
                    + x41 * (1.0e-6 * x11 * x7 - 0.063883 * x115 - 0.063883 * x13 * x43)
                    + x49 * (0.10593 * x1 * x27 - 0.00017505 * x113 - x125)
                    + 5.11984e-5 * x5
                    + x50 * (x1 * x39 + 0.009432 * x113 - 0.063883 * x126)
                    + x52 * (x1 * x120 + x1 * x121 - x123 + x124 * x43)
                    + x6 * x7
                    + x63 * (x118 * x56 + 0.10593 * x127)
                    + x66 * (-x116 * x56 - 0.00017505 * x127)
                    + x66
                    * (
                        0.011402 * x131
                        - 0.000281 * x132
                        + 0.011402 * x133
                        - 0.000281 * x134
                    )
                    + x68 * (1.0e-6 * x1 * x27 - x123 - 0.00965 * x127 - x129 * x56)
                    + x78 * (x1 * x130 - 0.045483 * x126 + 0.00965 * x128 - x129 * x54)
                    + x79 * (x1 * x33 - x116 * x54 - x125 + 0.00017505 * x128)
                    + x80
                    * (
                        -1.0e-6 * x115 * x54
                        + 0.045483 * x115 * x56
                        + 0.045483 * x127
                        + 1.0e-6 * x128
                    )
                    - x9 * (-4.4e-5 * x1 + 0.006641 * x7)
                    + x98
                    * (
                        -x115 * x135
                        - 0.029798 * x131
                        - 0.029798 * x133
                        + 0.000281 * x7 * x72
                    )
                )
            ],
            [
                gravity_acceleration
                * (
                    0.124859691 * x11 * x27 * x37
                    + 0.387012824 * x11 * x8
                    + x110
                    * (
                        -0.029798 * x101
                        + 0.029798 * x13 * x54 * x84
                        + 0.011402 * x13 * x56
                        - 0.011402 * x69
                    )
                    - 0.0257956812 * x13 * x23
                    + 0.000206331435 * x137 * x27
                    + 0.0257956812 * x137
                    - x21 * (-0.075478 * x11 + 1.8e-5 * x13)
                    + 0.0100396574 * x4
                    + x41 * (x11 * x39 + x122)
                    + x49 * (-x117 + x140)
                    + x50 * (x124 + 0.063883 * x138)
                    + x52 * (-x11 * x51 + x139)
                    + x63 * (-x33 * x57 - 0.10593 * x55)
                    + x66 * (0.00017505 * x55 + 0.00017505 * x58)
                    + x66
                    * (
                        0.000281 * x100 * x11
                        - 0.011402 * x83
                        - 0.011402 * x87
                        - 0.000281 * x99
                    )
                    + x68 * (x139 + 0.00965 * x55 + 0.00965 * x58)
                    + x78 * (0.045483 * x138 - 0.00965 * x141 + 0.00965 * x69)
                    + x79 * (x140 - 0.00017505 * x141 + 0.00017505 * x69)
                    - 5.11984e-5 * x8
                    + x80
                    * (
                        1.0e-6 * x11 * x27 * x54
                        - x130 * x57
                        - 1.0e-6 * x141
                        - 0.045483 * x55
                    )
                    + x98
                    * (
                        -0.000281 * x141
                        + 0.000281 * x69
                        + 0.029798 * x83
                        + 0.029798 * x87
                    )
                )
            ],
            [
                gravity_acceleration
                * (
                    x110 * (-0.029798 * x103 + 0.011402 * x144 + 0.029798 * x145)
                    - 0.4572224596 * x12
                    + x142 * x143
                    - 8.763003e-5 * x142 * x65
                    + 1.67436e-5 * x15
                    - 1.67436e-5 * x16
                    - 0.000206331435 * x17 * x28
                    - 0.4572224596 * x19
                    + 0.1681787533 * x27 * x48
                    - 0.1681787533 * x28 * x37
                    + x52 * (x120 + x121)
                    + x66
                    * (-0.000281 * x145 + x146 * x85 + x147 * x90 + 0.011402 * x89)
                    + x68 * (-0.00965 * x142 + 1.0e-6 * x27)
                    + x78 * (-0.00965 * x144 + 0.045483 * x27)
                    + x79 * (-0.00017505 * x144 + 0.10593 * x27)
                    + x80 * (-1.0e-6 * x144 + 0.045483 * x28 * x56)
                    + x98 * (-0.000281 * x144 - 0.029798 * x89 - 0.029798 * x91)
                )
            ],
            [
                gravity_acceleration
                * (
                    x110 * (x147 + x148 * x84)
                    - x143 * x54
                    + 6.781e-7 * x3 * x43
                    - 6.781e-7 * x35
                    + 0.006189507765 * x46
                    + 0.006189507765 * x47
                    + 0.00663129503 * x54 * x65
                    - 0.00663129503 * x56 * x77
                    + x66 * (-x135 * x84 - x136 * x82)
                    + x80 * (-0.045483 * x54 - 1.0e-6 * x56)
                    + x98 * (-x146 + x148 * x82)
                )
            ],
            [
                gravity_acceleration
                * (
                    0.0149168788 * x109 * x82
                    + 6.781e-7 * x17 * x56
                    - 6.781e-7 * x64
                    + x66 * (-0.000281 * x82 + 0.011402 * x84)
                    + 0.0838705803 * x75
                    + 0.0838705803 * x76
                    - 0.0149168788 * x84 * x97
                )
            ],
            [
                gravity_acceleration
                * (
                    -0.0057078412 * x107
                    + 0.0057078412 * x108
                    + 0.0001406686 * x95
                    + 0.0001406686 * x96
                )
            ],
        ]
    ).flatten()

    return gravity_term
