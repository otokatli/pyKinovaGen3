from numpy import array, cos, sin


def com_positions(q):
    '''
    Centre of mass positions of the Kinova Gen3 robot
    
    Arguments
    ---------
    q : array_like
        The joint angles of the robot
        
    Returns
    -------
    ndarray
        The centre of mass positions
    '''
    
    q1 = q[0]
    q2 = q[1]
    q3 = q[2]
    q4 = q[3]
    q5 = q[4]
    q6 = q[5]
    q7 = q[6]
    
    x0 = sin(q1)
    x1 = cos(q1)
    x2 = sin(q2)
    x3 = 0.09958*x2
    x4 = cos(q2)
    x5 = 4.4e-5*x4
    x6 = 4.4e-5*x2
    x7 = -0.0118*x0
    x8 = sin(q3)
    x9 = x0*x8
    x10 = cos(q3)
    x11 = x0*x10
    x12 = 0.328292*x2
    x13 = x1*x8
    x14 = x13*x4
    x15 = x1*x10
    x16 = -0.0118*x1
    x17 = x4*x9
    x18 = x2*x8
    x19 = sin(q4)
    x20 = x15*x4 - x9
    x21 = x19*x20
    x22 = cos(q4)
    x23 = x20*x22
    x24 = x19*x2
    x25 = x1*x24
    x26 = x2*x22
    x27 = x1*x26
    x28 = 0.4208*x2
    x29 = x1*x28 + x7
    x30 = -x11*x4 - x13
    x31 = x19*x30
    x32 = x22*x30
    x33 = x0*x24
    x34 = x0*x26
    x35 = -x0*x28 + x16
    x36 = x19*x4
    x37 = x22*x4
    x38 = x10*x26
    x39 = x10*x24
    x40 = 0.4208*x4 + 0.2848
    x41 = sin(q5)
    x42 = x23 - x25
    x43 = x41*x42
    x44 = cos(q5)
    x45 = x11 + x14
    x46 = x44*x45
    x47 = x42*x44
    x48 = x41*x45
    x49 = -0.0128*x11 - 0.0128*x14 + x29
    x50 = x32 + x33
    x51 = x41*x50
    x52 = x15 - x17
    x53 = x44*x52
    x54 = x44*x50
    x55 = x41*x52
    x56 = -0.0128*x15 + 0.0128*x17 + x35
    x57 = -x36 - x38
    x58 = x41*x57
    x59 = x44*x57
    x60 = x18*x41
    x61 = x18*x44
    x62 = 0.0128*x18 + x40
    x63 = cos(q6)
    x64 = x47 - x48
    x65 = x63*x64
    x66 = sin(q6)
    x67 = -x21 - x27
    x68 = x66*x67
    x69 = 0.045483*x66
    x70 = 0.045483*x63
    x71 = 0.3143*x21 + 0.3143*x27 + x49
    x72 = x54 - x55
    x73 = x63*x72
    x74 = -x31 + x34
    x75 = x66*x74
    x76 = 0.3143*x31 - 0.3143*x34 + x56
    x77 = x59 + x60
    x78 = x63*x77
    x79 = -x37 + x39
    x80 = x66*x79
    x81 = 0.3143*x37 - 0.3143*x39 + x62
    x82 = x43 + x46
    x83 = sin(q7)
    x84 = 0.000281*x83
    x85 = 0.135698*x66
    x86 = x65 + x68
    x87 = 0.011402*x83
    x88 = cos(q7)
    x89 = 0.011402*x88
    x90 = 0.000281*x88
    x91 = 0.135698*x63
    x92 = x51 + x53
    x93 = x73 + x75
    x94 = x58 - x61
    x95 = x78 + x80
    
    return array([[0.010364*x0 - 2.3e-5*x1, 2.3e-5*x0 + 0.010364*x1, 0.22976], [-0.018678*x0 + x1*x3 - x1*x5, -x0*x3 + x0*x5 - 0.018678*x1, 0.09958*x4 + x6 + 0.2848], [x1*x12 + 0.006641*x11 + 0.006641*x14 - x15*x5 + x7 + 4.4e-5*x9, -x0*x12 + x11*x5 + 4.4e-5*x13 + 0.006641*x15 + x16 - 0.006641*x17, x10*x6 - 0.006641*x18 + 0.328292*x4 + 0.2848], [-0.021406*x11 - 0.021406*x14 + 0.075478*x21 - 1.8e-5*x23 + 1.8e-5*x25 + 0.075478*x27 + x29, -0.021406*x15 + 0.021406*x17 + 0.075478*x31 - 1.8e-5*x32 - 1.8e-5*x33 - 0.075478*x34 + x35, 0.021406*x18 + 1.8e-5*x36 + 0.075478*x37 + 1.8e-5*x38 - 0.075478*x39 + x40], [0.272283*x21 + 0.272283*x27 + 0.009432*x43 + 0.009432*x46 + 1.0e-6*x47 - 1.0e-6*x48 + x49, 0.272283*x31 - 0.272283*x34 + 0.009432*x51 + 0.009432*x53 + 1.0e-6*x54 - 1.0e-6*x55 + x56, 0.272283*x37 - 0.272283*x39 + 0.009432*x58 + 1.0e-6*x59 + 1.0e-6*x60 - 0.009432*x61 + x62], [-0.00965*x43 - 0.00965*x46 + x64*x69 + 1.0e-6*x65 - x67*x70 + 1.0e-6*x68 + x71, -0.00965*x51 - 0.00965*x53 + x69*x72 - x70*x74 + 1.0e-6*x73 + 1.0e-6*x75 + x76, -0.00965*x58 + 0.00965*x61 + x69*x77 - x70*x79 + 1.0e-6*x78 + 1.0e-6*x80 + x81], [x64*x85 - x67*x91 + x71 + x82*x84 + x82*x89 + x86*x87 - x86*x90, x72*x85 - x74*x91 + x76 + x84*x92 + x87*x93 + x89*x92 - x90*x93, x77*x85 - x79*x91 + x81 + x84*x94 + x87*x95 + x89*x94 - x90*x95]])
